<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Hệ thống Hiến Máu Nhân Đạo</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <!-- SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/components.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/main-sections.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/home-pages.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/index-page.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/auth.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/profile-page.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/about-page.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/faq-page.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/guide-page.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/privacy-page.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/terms-page.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/sweetalert-demo-page.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/sweetalert-custom.css" asp-append-version="true" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="~/favicon.ico">
</head>
<body>
    <header class="navbar-section">
        <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">
            <div class="container">
                <!-- Brand -->
                <a class="navbar-brand d-flex align-items-center" asp-controller="Home" asp-action="Index">
                    <img src="~/image/Logo.png" alt="Blood Donation Logo" height="40" class="me-2 img-fluid" style="width:auto;max-width:60px;">
                    <span class="brand-text fw-bold text-danger">BloodLife</span>
                </a>

                <!-- Mobile Toggle -->
                <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Navigation -->
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Home" ? "active" : "")"
                               asp-controller="Home" asp-action="Index">
                                Trang chủ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "BloodDonationEvent" ? "active" : "")"
                               asp-controller="Events" asp-action="Index">
                                Sự kiện
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "News" ? "active" : "")"
                               asp-controller="News" asp-action="Index">
                                Tin tức
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Action"]?.ToString() == "About" ? "active" : "")"
                               asp-controller="Home" asp-action="About">
                                Giới thiệu
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Action"]?.ToString() == "Guide" ? "active" : "")"
                               asp-controller="Home" asp-action="Guide">
                                Hướng dẫn
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Action"]?.ToString() == "FAQ" ? "active" : "")"
                               asp-controller="Home" asp-action="FAQ">
                                FAQ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Contact" ? "active" : "")"
                               asp-controller="Contact" asp-action="Index">
                                Liên hệ
                            </a>
                        </li>
                    </ul>

                    <!-- User Authentication -->
                    <div class="d-flex align-items-center">
                        @if (User.Identity?.IsAuthenticated == true)
                        {
                            <div class="dropdown">
                                <button class="btn btn-outline-danger dropdown-toggle d-flex align-items-center user-dropdown-btn"
                                        type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    <i class="fas fa-user-circle me-2"></i>
                                    <span class="user-name-text">@(User.FindFirst("FullName")?.Value ?? User.Identity.Name)</span>
                                </button>
                                <ul class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="userDropdown">
                                    <li>
                                        <h6 class="dropdown-header">
                                            <i class="fas fa-user me-2"></i>@(User.FindFirst("FullName")?.Value ?? User.Identity.Name)
                                        </h6>
                                    </li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li>
                                        <a class="dropdown-item" asp-controller="Profile" asp-action="Index">
                                            <i class="fas fa-user me-2 text-primary"></i>Thông tin cá nhân
                                        </a>
                                    </li>
                                    <li>
                                        <a class="dropdown-item" asp-controller="Account" asp-action="ChangePassword">
                                            <i class="fas fa-key me-2 text-warning"></i>Đổi mật khẩu
                                        </a>
                                    </li>
                                    <li>
                                        <a class="dropdown-item" asp-controller="Registration" asp-action="MyRegistrations">
                                            <i class="fas fa-calendar-check me-2 text-success"></i>Đăng ký của tôi
                                        </a>
                                    </li>
                                    <li>
                                        <a class="dropdown-item" asp-controller="User" asp-action="DonationHistory">
                                            <i class="fas fa-history me-2 text-info"></i>Lịch sử hiến máu
                                        </a>
                                    </li>
                                    @if (User.IsInRole("Admin") || User.IsInRole("SuperAdmin"))
                                    {
                                        <li><hr class="dropdown-divider"></li>
                                        <li>
                                            <a class="dropdown-item" asp-controller="Admin" asp-action="Dashboard">
                                                <i class="fas fa-cog me-2 text-warning"></i>Quản trị hệ thống
                                            </a>
                                        </li>
                                    }
                                    @if (User.IsInRole("Doctor") || User.IsInRole("Nurse"))
                                    {
                                        <li>
                                            <a class="dropdown-item" asp-controller="HealthScreening" asp-action="Index">
                                                <i class="fas fa-stethoscope me-2 text-success"></i>Sàng lọc sức khỏe
                                            </a>
                                        </li>
                                    }
                                    <li><hr class="dropdown-divider"></li>
                                    <li>
                                        <div class="dropdown-item-group">
                                            <form asp-controller="Account" asp-action="Logout" method="post" class="d-inline w-100">
                                                <button type="submit" class="dropdown-item text-danger">
                                                    <i class="fas fa-sign-out-alt me-2"></i>Đăng xuất
                                                </button>
                                            </form>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        }
                        else
                        {
                            <div class="d-flex gap-2">
                                <a class="btn btn-outline-danger" asp-controller="Account" asp-action="Login">
                                    <i class="fas fa-sign-in-alt me-1"></i>
                                    <span>Đăng nhập</span>
                                </a>
                                <a class="btn btn-danger" asp-controller="Account" asp-action="Register">
                                    <i class="fas fa-user-plus me-1"></i>
                                    <span>Đăng ký</span>
                                </a>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main role="main" class="main-content">
        <!-- Breadcrumb (optional) -->
        @if (ViewData["ShowBreadcrumb"] as bool? == true)
        {
            <nav aria-label="breadcrumb" class="bg-light py-2">
                <div class="container">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item">
                            <a asp-controller="Home" asp-action="Index">
                                <i class="fas fa-home"></i> Trang chủ
                            </a>
                        </li>
                        @if (ViewData["BreadcrumbItems"] != null)
                        {
                            @Html.Raw(ViewData["BreadcrumbItems"])
                        }
                    </ol>
                </div>
            </nav>
        }

        <!-- Page Content -->
        @RenderBody()
    </main>

    <!-- Footer -->
    <footer class="footer-section bg-dark text-light mt-5">
        <div class="container">
            <div class="row py-5">
                <!-- Brand Column -->
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="footer-brand mb-3">
                        <img src="./image/Logo.png" alt="Blood Donation Logo" height="40" class="mb-2">
                        <h5 class="text-white fw-bold">BloodLife</h5>
                    </div>
                    <p class="text-muted mb-3">
                        Kết nối những trái tim nhân ái, cứu sống những sinh mạng quý giá.
                        Mỗi giọt máu hiến tặng là một cơ hội sống mới cho những người cần được giúp đỡ.
                    </p>
                    <div class="social-links">
                        <a href="#" class="text-light me-3 social-link" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="text-light me-3 social-link" title="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="text-light me-3 social-link" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="text-light social-link" title="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6 class="text-white mb-3 fw-bold">Liên kết nhanh</h6>
                    <ul class="list-unstyled footer-links">
                        <li><a asp-controller="Home" asp-action="Index" class="text-muted text-decoration-none">Trang chủ</a></li>
                        <li><a asp-controller="Events" asp-action="Index" class="text-muted text-decoration-none">Sự kiện hiến máu</a></li>
                        <li><a asp-controller="News" asp-action="Index" class="text-muted text-decoration-none">Tin tức</a></li>
                        <li><a asp-controller="Home" asp-action="About" class="text-muted text-decoration-none">Giới thiệu</a></li>
                        <li><a asp-controller="Contact" asp-action="Index" class="text-muted text-decoration-none">Liên hệ</a></li>
                    </ul>
                </div>

                <!-- Support -->
                <div class="col-lg-3 col-md-6 mb-4">
                    <h6 class="text-white mb-3 fw-bold">Hỗ trợ</h6>
                    <ul class="list-unstyled footer-links">
                        <li><a asp-controller="Home" asp-action="Guide" class="text-muted text-decoration-none">Hướng dẫn hiến máu</a></li>
                        <li><a asp-controller="Home" asp-action="Privacy" class="text-muted text-decoration-none">Chính sách bảo mật</a></li>
                        <li><a asp-controller="Home" asp-action="Terms" class="text-muted text-decoration-none">Điều khoản sử dụng</a></li>
                        <li><a asp-controller="Home" asp-action="FAQ" class="text-muted text-decoration-none">Câu hỏi thường gặp</a></li>
                        <li><a href="tel:1900-1234" class="text-muted text-decoration-none">Hotline: 1900-1234</a></li>
                    </ul>
                </div>

                <!-- Contact Info -->
                <div class="col-lg-3 col-md-6 mb-4">
                    <h6 class="text-white mb-3 fw-bold">Thông tin liên hệ</h6>
                    <div class="contact-info">
                        <div class="contact-item mb-2">
                            <i class="fas fa-map-marker-alt me-2 text-danger"></i>
                            <span class="text-muted">26 Nguyễn Thái Học, Ba Đình, Hà Nội</span>
                        </div>
                        <div class="contact-item mb-2">
                            <i class="fas fa-phone me-2 text-danger"></i>
                            <a href="tel:1900-1234" class="text-muted text-decoration-none">1900-1234</a>
                        </div>
                        <div class="contact-item mb-2">
                            <i class="fas fa-envelope me-2 text-danger"></i>
                            <a href="mailto:lienhe@hienmau.gov.vn" class="text-muted text-decoration-none">lienhe@hienmau.gov.vn</a>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-clock me-2 text-danger"></i>
                            <span class="text-muted">24/7 - Luôn sẵn sàng hỗ trợ</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer Bottom -->
            <hr class="border-secondary my-4">
            <div class="row py-3 align-items-center">
                <div class="col-md-6">
                    <p class="text-muted mb-0">
                        &copy; @DateTime.Now.Year BloodLife - Hệ thống Hiến Máu Nhân Đạo.
                        Tất cả quyền được bảo lưu.
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="text-muted mb-0">
                        Được phát triển với <i class="fas fa-heart text-danger"></i> tại Việt Nam
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <button type="button" class="btn btn-danger btn-floating btn-lg" id="btn-back-to-top" title="Về đầu trang">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Scripts -->
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- SweetAlert2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js"></script>
    
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="~/js/sweetalert-helper.js" asp-append-version="true"></script>
    <script src="~/js/logout.js" asp-append-version="true"></script>

    <!-- Custom Scripts -->
    <script>
        // Back to top button with improved animations
        let mybutton = document.getElementById("btn-back-to-top");
        let isVisible = false;

        window.onscroll = function () {
            scrollFunction();
        };

        function scrollFunction() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                if (!isVisible) {
                    mybutton.style.display = "flex";
                    mybutton.classList.add("show");
                    mybutton.classList.remove("hide");
                    isVisible = true;
                }
            } else {
                if (isVisible) {
                    mybutton.classList.add("hide");
                    mybutton.classList.remove("show");
                    setTimeout(() => {
                        if (!isVisible) return;
                        mybutton.style.display = "none";
                    }, 300);
                    isVisible = false;
                }
            }
        }

        mybutton.addEventListener("click", function () {
            // Smooth scroll to top
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Auto-hide alerts
        document.addEventListener('DOMContentLoaded', function () {
            setTimeout(function () {
                const alerts = document.querySelectorAll('.alert-dismissible');
                alerts.forEach(function (alert) {
                    const bsAlert = new bootstrap.Alert(alert);
                    bsAlert.close();
                });
            }, 5000);
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
    
    <!-- SweetAlert Notifications -->
    @await Html.PartialAsync("_SweetAlertNotifications")
</body>
</html>
